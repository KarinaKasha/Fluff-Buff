<!DOCTYPE html>
<html>

<head>
    <meta http-equiv="content-type" content="text/html; charset=utf-8">
    <title>Fluff & Buff Pet Spa</title>
    <meta name="description" content="груминг салон, стрижка собак и кошек">
    <meta name="keywords" content="стрижка собак, стрижка кошек">
    <meta name="author" content="https://vk.com/karinakshf">
    <link rel="StyleSheet" href="css/normalize.css" type="text/css">
    <link rel="StyleSheet" href="css/style.css" type="text/css">
    <link href="http://fonts.googleapis.com/css?family=PT+Sans+Narrow:400,700&amp;subset=latin,cyrillic" rel="stylesheet" type="text/css">
    <link rel="icon" href="img/iconka.png">
</head>

<body>
    <header class="main-header">
        <div class="container clearfix">
            <nav class="main-navigation">
                <ul>
                    <li class="main-navigation-item current-page">
                        <a href="index.html">главная</a>
                    </li>
                    <li class="main-navigation-item">
                        <a href="price.html">прайс-лист</a>
                    </li>
                    <li class="main-navigation-item">
                        <a href="catalog.html">магазин</a>
                    </li>
                </ul>
            </nav>
        </div>
    </header>
    <main class="container">
        <figure class="content-logo">
        <img src="img/content-lo.png" width="978" height="228" alt="логотип">
        </figure>
        <div class="content-advantages clearfix">
            <section class="content-advantages-block">
                <h2 class="content-advantages-title">Профессиональный уход</h2>
                <p>Наши опытные грумеры обладают знаниями и навыками для качественного ухода за шерстью, кожей и когтями вашего питомца</p>
            </section>
            <section class="content-advantages-block">
                <h2 class="content-advantages-title">Индивидуальный подход</h2>
                <p>Мы учитываем особенности каждого питомца, его породу, возраст и состояние здоровья, чтобы предоставить ему наилучший сервис</p>
            </section>
            <section class="content-advantages-block">
                <h2 class="content-advantages-title">Комфорт и безопасность</h2>
                <p>Наш салон оборудован современным оборудованием, мы используем качественные средства для ухода, чтобы обеспечить комфорт и безопасность питомцу</p>
            </section>
        </div>
        <div class="content-index-row clearfix">
            <section class="content-left-column content-news">
                <h2 class="content-column-title">новости</h2>
                <ul class="content-news-preview">
                    <li>
                        <p>у нас появился новый шампунь для питомцев - "FloopFloop"! теперь ваш любимец сможет насладиться профессиональным уходом и ощутить нежность и блеск после каждой процедуры</p>
                        <time datetime="2013-09-25">20 апреля</time>
                    </li>
                    <li>
                        <p>специальное предложение на стрижку и уход за шерстью! запишитесь на прием в нашем салоне груминга и получите скидку 20% на любую услугу</p>
                        <time datetime="2013-09-19">26 марта</time>
                    </li>
                </ul>
            </section>
        
            <section class="content-right-column content-gallery">
                <h2 class="content-column-title">фотогалерея</h2>
                <div class="content-gallery-block">
                  <div class="carusel carousel">
                    <div class="carousel-inner">
                      <figure class="content-gallery-img carousel-item">
                        <img src="img/salon.jpg" width="286" height="164" alt="интерьер">
                      </figure>
                      <figure class="content-gallery-img carousel-item">
                        <img src="img/salon3.jpg" width="286" height="164" alt="интерьер">
                      </figure>
                      <figure class="content-gallery-img carousel-item">
                        <img src="img/salon2.jpg" width="286" height="164" alt="интерьер">
                      </figure>
                    </div>
                  </div>
                  <button id="content-gallery-prev" class="btn content-gallery-prev" disabled>назад</button>
                  <button id="content-gallery-next" class="btn content-gallery-next">вперед</button>
                </div>
              </section>
        </div>
        
        <div class="content-index-row clearfix">
            <section class="content-left-column content-contacts">
                <h2 class="content-column-title">контактная информация</h2>
                <div class="content-contacts-block">
                    <p>Fluff & Buff Pet Spa</p>
                    <p>адрес: г. казань, ул. Ямашева, д. 15к2</p>
                </div>
                <div class="content-contacts-block">
                    <p>телефон: +7 (927) 321-63-87</p>
                    <p>время работы:</p>
                    <p>пн — пт: с 10:00 до 22:00</p>
                    <p>сб — вс: с 10:00 до 19:00</p>
                </div>
                <a href="https://yandex.ru/maps/43/kazan/house/prospekt_yamasheva_15k2/YEAYdg5nSEEEQFtvfXRzd31qZA==/" class="btn">как проехать</a>
            </section>
            <section class="content-right-column content-appointment-form">
                <h2 class="content-column-title">записаться</h2>
                <p>укажите желаемую дату и&nbsp;время и&nbsp;мы&nbsp;свяжемся с&nbsp;вами для подтверждения брони</p>
                <form id="form" name="form" method="post" action="https://script.google.com/macros/s/AKfycbyUEACVFPThIAyu-ds-IoQ6spQZ2--WnNXk6nkuOLYvCiUAiingHaQxWesvRKqIdvPiSg/exec">
                    <input type="date" name="date" value="" required="required">
                    <input type="time" name="time" value="" required="required">
                    <input type="text" name="name" value="" placeholder="ваше имя" >
                    <input type="tel" name="phone" value="" placeholder="телефон" required="required">
                    <button type="submit" id="submitForm" name ="btn-submit" class="btn btn-submit">отправить</button>
                </form>
            </section>
        </div>
    </main>
    <footer>
        <div class="container clearfix">
            <div class="footer-block footer-contacts">
                <p>Fluff & Buff Pet Spa</p>
                <p>адрес: г. казань, ул. Ямашева, д. 15к2</p>
                <a href="https://yandex.ru/maps/43/kazan/house/prospekt_yamasheva_15k2/YEAYdg5nSEEEQFtvfXRzd31qZA==/">как нас найти?</a>
                <p>телефон: +7 (927) 321-63-87</p>
            </div>
            <div class="footer-block  footer-social">
                <p>давайте дружить!</p>
                <a href="https://vk.com/karinakshf" class="btn footer-social-vk">вконтакте</a>
            </div>
        </div>
    </footer>
    <script>
        const URL_APP ="https://script.google.com/macros/s/AKfycbyUEACVFPThIAyu-ds-IoQ6spQZ2--WnNXk6nkuOLYvCiUAiingHaQxWesvRKqIdvPiSg/exec";

        // находим форму в документе
        const form = document.querySelector("#form");

        form.action = URL_APP;

        // вспомогательная функция проверки заполненности формы
        function isFilled(details) {
        const { date, time, name, phone } = details;
        if (!date) return false;
        if (!time) return false;
        if (!name) return false;
        if (!phone) return false;
        return true;
        }

        // навешиваем обработчик на отправку формы
        form.addEventListener("btn-submit", async (ev) => {
        // отменяем действие по умолчанию
        ev.preventDefault();
        
        const date = document.querySelector("[name=date]");
        const time = document.querySelector("[name=time]");
        const name = document.querySelector("[name=name]");
        const phone = document.querySelector("[name=phone]");
        

        // собираем данные из элементов формы
        let details = {
            date: date.value.trim(),
            time: time.value.trim(),
            name: name.value.trim(),
            phone: phone.value.trim(),
        };

        // если поля не заполнены - прекращаем обработку
        if (!isFilled(details)) return;

        // подготавливаем данные для отправки
        let formBody = [];
        for (let property in details) {
            // кодируем названия и значения параметров
            let encodedKey = encodeURIComponent(property);
            let encodedValue = encodeURIComponent(details[property]);
            formBody.push(encodedKey + "=" + encodedValue);
        }
        // склеиваем параметры в одну строку
        formBody = formBody.join("&");

        async function submitForm() {
        try {
        const result = await fetch(URL_APP, { 
            method: "POST", 
            headers: {
            "Content-Type": "application/x-www-form-urlencoded;charset=UTF-8",
            },
            mode: "cors",
            body: formBody,
        });
        const data = await result.json();

        if (data.type === 'success') {
            alert('Спасибо за заявку!')
        } else if (data.type === 'error') {
            alert('Ошибка!')
        }
    }  
        catch (error) {
        alert("Ошибка!");
        console.error(error);
    }
}
document.getElementById("#form").addEventListener("submit", submitForm);
        
// выполняем отправку данных в Google Apps
        /*const result = await fetch(URL_APP, {
            method: "POST",
            headers: {
            "Content-Type": "application/x-www-form-urlencoded;charset=UTF-8",
            },
            mode: "cors",
            body: formBody,
        })

        
        .then((res) => res.json())
        .catch((err) => alert("Ошибка!"))
        .then((res) => console.log(res));
            
        if( result.type === 'success' ) {
            date.value = '';
            time.value = '';
            name.value = '';
            phone.value = '';
            alert('Спасибо за заявку!')
        }
        if( result.type === 'error' ) {            
            alert(`Ошибка( ${result.errors}`)
        }
        fetch(URL_APP, {
            })
            .then(res => res.json())
            .catch(err => alert("Ошибка!"))
            .then(result => {
                if (result.type === 'success') {
                    alert('Спасибо за заявку!');
                } else if (result.type === 'error') {
                    alert('Ошибка: ${result.errors}');
                }
            }
            );*/
                        
        });
    </script>
    <script>
        let currentIndex = 0;
        const carouselItems = document.querySelectorAll('.carousel-item');
        const nextButton = document.querySelector('.content-gallery-next');
        const prevButton = document.querySelector('.content-gallery-prev');

        function goToSlide(index) {
        if (index < 0) {
            index = carouselItems.length - 1;
        } else if (index >= carouselItems.length) {
            index = 0;
        }

        currentIndex = index;
        document.querySelector('.carousel-inner').style.transform = `translateX(-${currentIndex * 100}%)`;

        prevButton.disabled = (index === 0);
        nextButton.disabled = (index === carouselItems.length - 1);
        }

        function goToNextSlide() {
        goToSlide(currentIndex + 1);
        }

        function goToPrevSlide() {
        goToSlide(currentIndex - 1);
        }

        nextButton.addEventListener('click', goToNextSlide);
        prevButton.addEventListener('click', goToPrevSlide);

        goToSlide(0); 

    </script>
</body>


</html>